\chapter[DOE]{Design of Experiments - DOE}

This chapter is devoted to the matter of designing experiments.
A control chart may be seen as an on-line running experiment alerting us when things go sour. W
When designing a product (remember DFSS \ref{sec:dfss}), or one a control chart has signalled an alert, we will want to know what influences our production.
In our SPC terminology, we will want to know what are the \emph{causal} \emph{effect} of our \emph{controllable inputs}, or \emph{factors} influence our CTQ, or \emph{response}. 
The theory of discovering these effects is the theory of \emph{design of experiments} (DOE).



Before we dig in, two matters should be emphasized:
\begin{description}
\item [Randomization] Randomization is an essential to our purposes. This because the idea of an \emph{effect} implies causality. Any inference we make, is causal, which is the inference we need for controlling a process.
It is the mechanism of randomization, that allows us to conclude that inferred correlations are causal, and not merely statistical.
For a treatment of causal inference in \emph{observational data}, i.e., without randomization, see \cite{rosenbaum_observational_2002}.

\item [Pre-experiment] In this text we take it for granted that the purpose of the experiment is well known, and the candidate factors defined. We are fully aware, as should be the reader, that in application this is a non-trivial luxury. Indeed, a lot of planning, and domain-knowledge go into the selection of factors, their candidate levels, etc.

\end{description}



\begin{remark}[Data Analysis]
In this text, we only discuss the \textbf{design} of the experiment, and not the \textbf{analysis} of the data.
This is a non-standard choice as DOE is typically presented alongside the \emph{analysis of variance} (ANOVA) analysis framework.\marginnote{ANOVA}
We decouple the two since: 
(a) these are two different things, and 
(b) the language of ANOVA may be replaced, and has indeed been in many contexts, by the language of \emph{linear models}.
There is a vast literature on analysis methods. 
If asked, this author may recommend \cite{hocking_analysis_1985}, which presents both the ANOVA terminology, and the linear models terminology.
That book, however, may be hard to come by, in which case, I also recommend \cite{mason_statistical_2003}.
\end{remark}





\section{Terminology}
Compiled from \cite{mason_statistical_2003}. Many, if not most of the following terms, originate in R.A. Fisher's seminal book ``The Design of Experiments'' \citep{fisher_design_1960}. As usual, when old ideas get new names, we try to emphasize this in the text.



\begin{description}

\item [Experimental Unit]  Entity on which a measurement or an observation is made;
sometimes refers to the actual measurement or observation.
\item [Homogenous Experimental Unit] Units that are as uniform as possible on all characteristics that could affect the response.

\item [Factors]  A controllable experimental variable that is thought to influence the response. In the language of SPC: \emph{a controllable input}.

\item [Level] Specific value of a factor.

\item[Treatment] The particular factor-level combination applied to an experimental unit.

\item [Factor Encodings] The numerical encoding of factor levels.
Two level factor encodings include:
\begin{enumerate}
\item Effect coding: where levels are encoded with $-1,1$ returning orthogonal design matrices for balanced designs.
\item Dummy coding: where levels are encoded with $0,1$ returning easily interpretable coefficients.
\end{enumerate}

\item [Experimental Region] All possible factor–level combinations for which experimentation is possible. \Aka \emph{factor space}.

\item [Design Matrix] A matrix description of an experiment that is useful for constructing and analyzing experiments.

\item [Response] The CTQ.

\item [Main Effect] Change in the expected response between two factor–levels.  

\item [Interaction] Existence of joint factor effects in which the effect of each factor depends on the levels of the other factors.

\item [Replication] Repetition of an entire experiment or a portion of an experiment under two or more sets of conditions.

\item [Covariate]  An uncontrollable variable that influences the response but is
unaffected by any other experimental factors.

\item [Design]  Complete specification of experimental test runs, including blocking, randomization, repeat tests, replication, and the assignment of factor–level combinations to experimental units.

\item [Balanced Design] An experimental design where all cells (i.e. treatments) have the same number of observations.

\item [Block] Group of homogeneous experimental units.

\item [Confounding] When the design is such that several effects cannot be told apart. \Aka \emph{aliasing}.

\item [Repeat Tests] Two or more observations that have the same levels for all the factors.

\end{description}







\section{Fully Randomized Designs}
Fully randomized designs are those where we can freely (randomly) assign experimental units to treatments.


\subsection{Full Factorial}
A \emph{full factorial} design is one where all factor-level combinations are tested.
In a \emph{balanced full factorial} design, all factor level combinations undergo the same number of \emph{test repeats}.

By far the most common design, in which $k$ factors have 2 levels, is named a $2^k$-design.
Less common, but not surprisingly, $k$ factors with 3 levels is names $3^k$-design, etc.

\subsubsection{$2^1$ design}
Well, this is your usual A/B test. 
There is not much to be said about the design of such experiments, and the analysis is pretty much your good old t-test.

\subsubsection{$2^2$ design}
Consider two factors: $A$ and $B$.
Adopt the effect coding so that we encode their levels by $-1,1$.
The design matrix of a single run will look like this:
\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
  Condition n. & A & B \\ 
  \hline
1 & -1 & -1 \\ 
  2 & 1 & -1 \\ 
  3 & -1 & 1 \\ 
  4 & 1 & 1 \\ 
   \hline
\end{tabular}
\caption{A $2^2$ design. As generated with \rcode{gen.factorial()} in the \rcode{AlgDesign} \R package.}
\end{table}



\subsection{Fractional Factorial}

\subsubsection{Confounding of Effects}

\subsubsection{Design Resolution}


\subsection{Screening Experiments}

\section{Random Effects}

\subsection{Randomized Block Designs}

\subsubsection{Complete Block Designs}


\subsubsection{Latin Square Design}

\subsubsection{Latin Square Design}

\subsubsection{Cross Over Design}

\subsubsection{Incomplete Block Designs}


\subsection{Random Effects Facotor}

\subsection{Nested Designs}


\subsubsection{Nested and Crossed Designs}

\subsubsection{Split Plot Designs}




\subsection{Process Improvement Designs}

\subsubsection{Taguchi's Robust Design Approach}



\section{Continuous Factors}



\subsection{Response Surface Methdology}

\subsubsection{Central Composite Design}

\subsubsection{Box-Behnken Design}




\section{Sequential Designs}

\subsection{Po}



\section{Adaptive Designs}



\section{Computer Experiments}

